<html lang="en">
  <head>
    <title>Kamon | Documentation | Reporting Data to Fluentd</title>

<meta charset="utf-8">
<meta name="viewport"    content="width=device-width, initial-scale=1.0">
<meta name="description" content="Kamon is a set of tools that will help you monitor your reactive applications">

<!--<link rel="stylesheet" href="/assets/css/syntax-highlight.css">-->
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/assets/css/prism.css">
<link rel="stylesheet" href="/assets/css/styles.css">
<link rel="stylesheet" href="/assets/css/kamon.css">


<link rel="shortcut icon" href="/assets/img/favicon.ico" type="image/x-icon">
<link rel="icon" href="/assets/img/favicon.ico" type="image/x-icon">
<link href="https://plus.google.com/107736741680270898032?rel=author">
<link rel="alternate" type="application/rss+xml" title="Kamon Teamblog Feed" href="/teamblog/rss/">

<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

  </head>
  <body>
    <nav class="navbar navbar-default kamon-navbar">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-12 col-md-3">
          <a href="/documentation/get-started/">
            <img class="kamon-logo-image" alt="Kamon" src="/assets/img/kamon-logo-latest.svg">
          </a>
      </div>

      <div class="col-12 col-md-9">
        <div class="row justify-content-end align-items-center navigation-links">
            <div class="wip-warning col-12 col-md-4">
              WARNING: We are updating and fixing all docs around!
            </div>
            <a class="col-12 col-md-4 col-lg-3" href="/documentation/get-started/">
              <span class="nav-link">DOCUMENTATION</span>
            </a>
            <a class="col-12 col-md-2" href="/teamblog/">
              <span class="nav-link">BLOG</span>
            </a>
            
            <div class="col-12 col-md-2 hidden-sm-down">
              <div class="row justify-content-around align-items-center">
                <a href="https://twitter.com/kamonteam">
                  <i class="fa fa-twitter fa-lg nav-icon" aria-hidden="true"></i>
                </a>
                <a href="https://github.com/kamon-io/Kamon">
                  <i class="fa fa-github fa-lg nav-icon" aria-hidden="true"></i>
                </a>
                <a href="http://kamon.io/teamblog/rss/">
                  <i class="fa fa-rss fa-lg nav-icon" aria-hidden="true"></i>
                </a>
                <a href="https://groups.google.com/forum/#!forum/kamon-user">
                  <i class="fa fa-envelope fa-lg nav-icon" aria-hidden="true"></i>
                </a>
              </div>
            </div>
        </div>
      </div>
    </div>
  </div>
</nav>
      <div class="hero jumbotron-top">
    <div class="container">
      <div class="row">
        <div class="col-xs-12 col-md-7">
          <span class="jumbo-title">Documentation</span>
        </div>
      </div>
    </div>
  </div>  

    <div class="container">
      <div class="row">
        <div class="col-12 col-md-9 push-md-3">
          <div class="row align-items-center justify-content-end kamino-docs-top">
            <div>
                <a href="https://kamino.io">
                  <img class="img-fluid" alt="Sponsored by Kamino" src="/assets/img/sponsored-by-kamino.svg">
                </a>
            </div>
          </div>
          <div class="row docs-content">
            <div class="col-12">
              <h1 id="reporting-metrics-to-fluentd">Reporting Metrics to Fluentd</h1>
<p><a href="http://www.fluentd.org/">Fluentd</a> is distributed, reliable, realtime and programmable data collector. Fluentd’s 300+ plugins connect it to <a href="http://www.fluentd.org/datasources">many data sources</a> and <a href="http://www.fluentd.org/dataoutputs">data outputs</a> while keeping its core small and fast (30-40MB memory footprint). And, <a href="http://www.fluentd.org/testimonials">2,000+ data-driven companies</a> rely on Fluentd to differentiate their products with better use of data.</p>

<p><code>kamon-fluentd</code> module provides capabilities to send kamon metrics to fluentd server. The module provides kamon users huge flexibility on interacting with kamon metrics because user can use bunch of <a href="http://www.fluentd.org/plugins">fluentd-plugin ecosystem</a> for reforming, filtering and forwarding kamon-metrics to anywhere.</p>

<h2 id="installation">Installation</h2>

<p>Add the <code>kamon-fluentd</code> dependency to your project and ensure that it is in your classpath at runtime, that’s it.
Kamon’s module loader will detect that the Fluentd module is in the classpath and automatically start it.</p>

<h2 id="configuration">Configuration</h2>

<p>By default, this module assumes that you have an instance of the Fluentd daemon running in localhost and listening on port 24224. If that is not the case the you can use the <code>kamon.fluentd.hostname</code> and <code>kamon.fluentd.port</code> configuration keys to point the module at your Fluentd daemon.</p>

<p>The Fluentd module subscribes itself to the entities included in the <code>kamon.fluentd.subscriptions</code> key. By default, the following subscriptions are included:</p>

<pre class="line-numbers language-typesafeconfig"><code class="language-typesafeconfig">kamon.fluentd {
  subscriptions {
    histogram       = [ "**" ]
    min-max-counter = [ "**" ]
    gauge           = [ "**" ]
    counter         = [ "**" ]
    trace           = [ "**" ]
    trace-segment   = [ "**" ]
    akka-actor      = [ "**" ]
    akka-dispatcher = [ "**" ]
    akka-router     = [ "**" ]
    system-metric   = [ "**" ]
    http-server     = [ "**" ]
  }
}</code></pre>

<p>If you are interested in reporting additional entities to Fluentd please ensure that you include the categories and name patterns accordingly.</p>

<h3 id="customizing-statistical-metrics-over-histogram-snapshots">Customizing Statistical Metrics over Histogram Snapshots</h3>
<p>You can also configure statistical metrics over histogram snapshots via <code>kamon.fluentd.histogram-stats</code> property.</p>

<pre class="line-numbers language-typesafeconfig"><code class="language-typesafeconfig">kamon.fluentd {
  # statistic values to be reported for histogram type metrics
  # (i.e. Histogram, MinMaxCounter, Gauge).
  histogram-stats {
    # stats values:
    # "count", "min", "max", "average", "percentiles" are supported.
    # you can use "*" for wildcards.
    subscription = [ "count", "min", "max", "average", "percentiles" ],

    # percentile points:
    # this will be used when you set "percentiles" in "subscription" above.
    # In this example, kamon-fluentd reports 50th 90th, 99th and 99.9th percentiles.
    percentiles = [50.0, 90.0, 99.0, 99.9]
  }
}</code></pre>

<h3 id="json-formats-passed-to-fluentd">Json Formats passed to Fluentd</h3>

<p>Fluentd’s messages are represented by JSON format.  Sample Json Format generetad by the module is below:</p>

<pre class="line-numbers language-json"><code class="language-json">{
  "time": 1445776940
  "tag": "kamon.fluentd.kamon-fluentd-example.akka-actor.kamon/user/metrics.mailbox-size",
  "app.name":"kamon-fluentd-example",
  "category.name":"akka-actor",
  "metric.name":"mailbox-size",
  "entity.name":"kamon/user/metrics",
  "stats.name":"average",
  "value": 2.0,
  "unit_of_measurement.name":"unknown",
  "unit_of_measurement.label":"unknown",
  "tags.some_tag_key":"some_tag_value",
  "canonical_metric.name":"kamon-fluentd-example.akka-actor.kamon/user/metrics.mailbox-size.average",
  "kamon-fluentd-example.akka-actor.kamon/user/metrics.mailbox-size.average": 2.0
}</code></pre>

<p>Fluentd’s JSON must have <code>time</code> and <code>tag</code> properties. <code>tag</code> is the property which is used for identifying data streams in Fluentd. <code>tag</code> which are generated by the module consists of tag prefix and canonical metric name. You can configure tag prefix via <code>kamon.fluentd.tag</code> property.</p>

<p>Naming convention of canonical metric name is as follows:</p>

<ul>
  <li>
    <p>For all single instrument entities (those tracking counters, histograms, gaugues and min-max-counters), tag name will be <code>&lt;app.name&gt;.&lt;instrument.type&gt;.&lt;entity.name&gt;.&lt;stats.name&gt;</code>. Instrument type will be <code>counter</code>, <code>histogram</code> and etc.. stats name will be <code>count</code>, <code>min</code>, <code>max</code>, <code>average</code>, <code>percentiles.50</code>, etc. depending on instrument type.</p>
  </li>
  <li>
    <p>For all other entities the pattern is a little different. the pattern will be <code>&lt;app.name&gt;.&lt;category.name&gt;.&lt;entity.name&gt;.&lt;metric.name&gt;.&lt;stats_name&gt;</code>.  For example, mailbox-size measurements of <code>actor:kamon/user/metrics</code> are reported under the <code>&lt;app.name&gt;.akka-actor.kamon/user/metrics.mailbox-size.&lt;stats_name&gt;</code> metrics.</p>
  </li>
</ul>

<p>You can configure <code>&lt;app_name&gt;</code> via <code>kamon.fluend.application-name</code>.</p>

<p>For all tags which are set in Kamon entities, please be noted that <code>tag</code> property in JSON message above is different from this, they will be embedded into Json messages as the form of <code>"tags.&lt;tag_key&gt;" : &lt;tag_value&gt;</code>.</p>

<p>“canonical_metric.name” and <code>&lt;canonical_metric.name&gt; : &lt;value&gt;</code> will be embedded too for user’s convenience.</p>

<h2 id="integration-notes">Integration Notes</h2>

<p>We don’t flush the metrics data as soon as the measurements are taken but instead, all metrics data is buffered by the <code>kamon-fluentd</code> module and flushed periodically using the configured <code>kamon.fluentd.flush-interval</code>.</p>

<h2 id="examples">Examples</h2>
<p>Please look at <a href="https://github.com/kamon-io/Kamon/tree/master/kamon-examples/kamon-fluentd-example">kamon-fluentd-example</a> for further details.</p>


            </div>
          </div>
          <!--<div class="row align-items-center kamino-docs-bottom">
            <div class="col-xs-offset-1 col-xs-5">
                <a href="http://kamino.io">
                  <img class="img-fluid" alt="Sponsored by Kamino" src="/assets/img/sponsored-by-kamino.svg">
                </a>
                <a class="btn btn-sign-up btn-lg">Visit kamino.io</a>
            </div>
          </div>-->
        </div>

        <div class="col-12 col-md-3 pull-md-9 documentation-sidebar">
          <section>
  <ul class="tree">
    <li><a class="docs-level-three side" href="/documentation/get-started/"></i>Get Started</a></li>
    <li><a class="docs-level-three side" href="/documentation/events-and-workshops/"></i>Upcoming Events</a></li>
  </ul>
</section>
          


<section>
  <div class="tree tree-toggler docs-level-one row justify-content-between align-items-center">
    <span>
      kamon-fluentd
    </span>

    <div class="dropdown version-dropdown">
      <a class="btn btn-secondary dropdown-toggle" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        0.6.6
      </a>

      <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
        
          <a class="dropdown-item" href="/documentation/kamon-fluentd/0.6.6/overview/">0.6.6</a>
        
      </div>
    </div>
  </div>

  <ul>
    
      <li><a class="docs-level-three" href="/documentation/kamon-fluentd/0.6.6/overview/">Reporting to FluentD</a></li>
    

    
</section>
          <section>
  <div class="tree tree-toggler docs-level-one row align-items-center">
    <span>All Modules</span>
  </div>
  <ul class="tree tree-toggler">
    <li>
      <label class="tree-toggler tree docs-level-two">Foundations</label>
      <ul>
        <li><a class="docs-level-three" href="/documentation/kamon-core/0.6.6/overview/">Metrics and Tracing</a></li>
      </ul>
    </li>

    <li>
      <label class="tree-toggler tree docs-level-two">Metrics Collection</label>
      <ul>
        <li><a class="docs-level-three" href="/documentation/kamon-akka/0.6.6/overview/">Akka</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-scala/0.6.6/overview/">Scala Futures</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-play/0.6.6/overview/">Play Framework</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-spray/0.6.6/overview/">Spray</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-jdbc/0.6.6/overview/">JDBC</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-annotation/0.6.6/overview/">Annotations</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-system-metrics/0.6.6/overview/">System Metrics</a></li>
      </ul>
    </li>

    <li>
      <label class="tree-toggler tree docs-level-two">Reporter Backends</label>
      <ul>
        <!--<li><a class="docs-level-three" href="/documentation/kamon-kamino/0.6.6/overview/">Kamino</a></li>-->
        <li><a class="docs-level-three" href="/documentation/kamon-statsd/0.6.6/overview/">StatsD</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-datadog/0.6.6/overview/">Datadog</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-newrelic/0.6.6/overview/">New Relic</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-sematext-spm/0.6.6/overview/">Sematext SPM</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-jmx/0.6.6/overview/">JMX</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-fluentd/0.6.6/overview/">FluentD</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-influxdb/0.6.6/overview/">InfluxDB</a></li>
        <!--<li><a class="docs-level-three" href="/documentation/kamon-graphite/1.0.4/overview/">Graphite</a></li>-->
        <li><a class="docs-level-three" href="/documentation/kamon-riemann/0.6.6/overview/">Riemann</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-khronus/0.6.6/overview/">Khronus</a></li>

      </ul>
    </li>    
  </ul>
</section>
        </div>

      </div>
    </div>

    <div class="hero jumbotron-bottom">
  <div class="container">
    <div class="row middle-xs">
      <div class="col-xs-12">
        
      </div>
    </div>
  </div>
</div>


<!--<footer class="footer">
  <div class="container">
    <div class="row">
      <div class="col-sm-8 col-sm-offset-2">
        <p class="text-center upper">
          Get in touch
        </p>
        <p class="text-center">
          <a href="https://twitter.com/kamonteam" class="social-icon"><i class="fa fa-twitter"></i></a>
          <a href="https://github.com/kamon-io/Kamon" class="social-icon"><i class="fa fa-2x fa-github"></i></a>
          <a href="/teamblog/rss/" class="social-icon"><i class="fa fa-rss"></i></a>
          <a href="https://groups.google.com/forum/#!forum/kamon-user" class="social-icon"><i class="fa fa-envelope"></i></a>
        </p>
        <p class="text-center">
          <a href="/introduction/project-info/support/" class="btn btn-support upper">Support <i class="fa fa-wrench"></i></a>
        </p>
        <p class="text-center">
          <img src="/assets/img/kamon-footer-logo.png" alt="logo" />
        </p>
        <p class="copyright">
          &copy; 2015 Kamon. All rights reserved.
        </p>
      </div>
    </div>
  </div>
</footer>-->



    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="/assets/js/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/assets/js/tether.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
    <script src="/assets/js/prism.js"></script>
    <script src="/assets/js/prism-typesafeconfig.js"></script>
    <script>

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-45369085-1', 'kamon.io');
    ga('send', 'pageview');

</script>

  </body>
</html>
