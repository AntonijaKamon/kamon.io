<html lang="en">
  <head>
    <title>Kamon | Documentation</title>

<meta charset="utf-8">
<meta name="viewport"    content="width=device-width, initial-scale=1.0">
<meta name="description" content="Kamon is a set of tools that will help you monitor your reactive applications">

<!--<link rel="stylesheet" href="/assets/css/syntax-highlight.css">-->
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/assets/css/prism.css">
<link rel="stylesheet" href="/assets/css/styles.css">
<link rel="stylesheet" href="/assets/css/kamon.css">


<link rel="shortcut icon" href="/assets/img/favicon.ico" type="image/x-icon">
<link rel="icon" href="/assets/img/favicon.ico" type="image/x-icon">
<link href="https://plus.google.com/107736741680270898032?rel=author">
<link rel="alternate" type="application/rss+xml" title="Kamon Teamblog Feed" href="/teamblog/rss/">

<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

  </head>
  <body>
    <nav class="navbar navbar-default kamon-navbar">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-12 col-md-3">
          <a href="/documentation/get-started/">
            <img class="kamon-logo-image" alt="Kamon" src="/assets/img/kamon-logo-latest.svg">
          </a>
      </div>

      <div class="col-12 col-md-9">
        <div class="row justify-content-end align-items-center navigation-links">
            <div class="wip-warning col-12 col-md-4">
              WARNING: We are updating and fixing all docs around!
            </div>
            <a class="col-12 col-md-4 col-lg-3" href="/documentation/get-started/">
              <span class="nav-link">DOCUMENTATION</span>
            </a>
            <a class="col-12 col-md-2" href="/teamblog/">
              <span class="nav-link">BLOG</span>
            </a>
            
            <div class="col-12 col-md-2 hidden-sm-down">
              <div class="row justify-content-around align-items-center">
                <a href="https://twitter.com/kamonteam">
                  <i class="fa fa-twitter fa-lg nav-icon" aria-hidden="true"></i>
                </a>
                <a href="https://github.com/kamon-io/Kamon">
                  <i class="fa fa-github fa-lg nav-icon" aria-hidden="true"></i>
                </a>
                <a href="http://kamon.io/teamblog/rss/">
                  <i class="fa fa-rss fa-lg nav-icon" aria-hidden="true"></i>
                </a>
                <a href="https://groups.google.com/forum/#!forum/kamon-user">
                  <i class="fa fa-envelope fa-lg nav-icon" aria-hidden="true"></i>
                </a>
              </div>
            </div>
        </div>
      </div>
    </div>
  </div>
</nav>
      <div class="hero jumbotron-top">
    <div class="container">
      <div class="row">
        <div class="col-xs-12 col-md-7">
          <span class="jumbo-title">Documentation</span>
        </div>
      </div>
    </div>
  </div>  

    <div class="container">
      <div class="row">
        <div class="col-12 col-md-9 push-md-3">
          <div class="row align-items-center justify-content-end kamino-docs-top">
            <div>
                <a href="https://kamino.io">
                  <img class="img-fluid" alt="Sponsored by Kamino" src="/assets/img/sponsored-by-kamino.svg">
                </a>
            </div>
          </div>
          <div class="row docs-content">
            <div class="col-12">
              <h1 id="actor-router-and-dispatcher-metrics">Actor, Router and Dispatcher Metrics</h1>

<p>Kamon is able to gather metrics from the actors, dispatchers and routers that you create in your application by joining
bytecode instrumentation that melds into Akka’s internals with our metrics module.</p>

<p>Since your application might be creating thousands of different actors, routers or even several dispatchers, Kamon wont
simply catch them all but rather rely on the <a href="/core/metrics/core-concepts/">entity filters</a> described in the metrics section for you to decide which
actors, routers and dispatchers should be measured and which don’t. The supported categories are prefixed with <code>akka-</code>
and the name patterns must include the actor system name as it’s first component.</p>

<div class="code-example"><ul class="nav nav-tabs language-tab justify-content-end" role="tablist"><li class="nav-item"><a class="nav-link active" data-toggle="tab" href="#typesafeconfig_0_757297" role="tab">application.conf</a></li></ul><div class="tab-content"><div class="tab-pane active" id="typesafeconfig_0_757297" role="tabpanel"><pre class="line-numbers language-typesafeconfig"><code class="language-typesafeconfig">kamon.metric.filters {
  akka-actor {
    includes = [ &quot;my-app/user/job-manager&quot;, &quot;my-app/user/worker-*&quot; ]
    excludes = [ &quot;my-app/system/**&quot;, &quot;my-app/user/worker-helper&quot; ]
  }

  akka-dispatcher {
    includes = [ &quot;my-app/akka.actor.default-dispatcher&quot;, &quot;my-app/database-dispatcher&quot; ]
  }

  akka-router {
    includes = [ &quot;my-app/user/some-router&quot; ]
  }
}
</code></pre></div></div></div>

<p>In the example filters above, for an actor system named <code>my-app</code>, all system actors and the <code>user/worker-helper</code> actor
are excluded but the <code>user/job-manager</code> and all the <code>user/worker-*</code> actors should be tracked. With regards to
dispatchers, only the default dispatcher in the application’s actor system and the <code>database-dispatcher</code> are tracked.
Finally, the <code>user/some-router</code> router is the only one to be tracked by Kamon.</p>

<p>Once one of these entities is accepted by the configured filters, the correspondent entity recorder will be registered
and work as any other entity recorded in the metrics module, meaning that you can also configure the instruments via the
configuration file or subscribe to it’s metrics data using the provided categories.</p>

<p>Now let’s dig into the specific metrics provided for each of these entities.</p>

<h2 id="actor-metrics">Actor Metrics</h2>

<p>When an actor is tracked, the following metrics will be recorded:</p>

<ul>
  <li><strong>time-in-mailbox</strong>: a histogram that tracks the time measured from the moment a message was enqueued into an actor’s
mailbox until the moment it was dequeued for processing.</li>
  <li><strong>processing-time</strong>: a histogram that tracks how long did it take for the actor to process every message.</li>
  <li><strong>mailbox-size</strong>: a min max counter that tracks the size of the actor’s mailbox.</li>
  <li><strong>errors</strong>: a simple counter with the number of failures the actor has experienced.</li>
</ul>

<h2 id="router-metrics">Router Metrics</h2>

<p>For each tracked router you will get:</p>

<ul>
  <li><strong>routing-time</strong>: a histogram that tracks how long did it take to the router itself to decide which of it’s routees
will process the message.</li>
  <li><strong>time-in-mailbox</strong>: a histogram that tracks the combined time measured from the moment a message was enqueued into a
routee’s mailbox until the moment it was dequeued for processing. The measurements from all routees are combined here.</li>
  <li><strong>processing-time</strong>: a histogram that tracks how long did it take for each of the routees to process incoming messages.</li>
  <li><strong>errors</strong>: a simple counter with the number of failures of the routees in the router.</li>
</ul>

<p>Please note that actor and router metrics are independent from each other, you could be tracking a router without having
to track each of the routees independently, or, you could track a individual actor that is part of a router, without
having to track the router itself. Or you could do both router and routees, if you want.</p>

<h2 id="dispatcher-metrics">Dispatcher Metrics</h2>

<p>The metrics provided for each dispatcher will vary depending on the type of dispatcher at hand. To know for sure what
kind of dispatcher you are looking at, we will always include a tag named <code>dispatcher-type</code> whose value will always be
present and be either <code>fork-join-pool</code> for <code>thread-pool-executor</code>, matching the type of dispatcher that you actually
created.</p>

<h3 id="fork-join-pool-dispatchers">Fork Join Pool Dispatchers</h3>

<p>When your dispatchers are <code>fork-join-pool</code> dispatchers, you will get:</p>

<ul>
  <li><strong>parallelism</strong>: a min max counter with the desired parallelism value. This value will remain steady over time.</li>
  <li><strong>pool-size</strong>: a gauge tracking the number of worker threads that have started but not yet terminated. This value will
differ that of <code>parallelism</code> if threads are created to maintain parallelism when others are cooperatively blocked.</li>
  <li><strong>active-threads</strong>: a gauge tracking an estimate of the number of threads that are currently stealing or executing
tasks.</li>
  <li><strong>running-threads</strong>: a gauge tracking an estimate of the number of worker threads that are not blocked waiting to join
tasks or for other managed synchronization.</li>
  <li><strong>queued-task-count</strong>: a gauge tracking  the total number of tasks currently held in queues by worker threads (but not
including tasks submitted to the pool that have not begun executing). This value is only an approximation, obtained by
iterating across all threads in the pool.</li>
</ul>

<h3 id="thread-pool-executor-dispatchers">Thread Pool Executor Dispatchers</h3>

<p>On the other hand, when your dispatcher type is <code>thread-pool-executor</code> you will get:</p>

<ul>
  <li><strong>core-pool-size</strong>: a gauge tracking the core pool size of the executor.</li>
  <li><strong>max-pool-size</strong>: a gauge tracking the maximum number of threads allowed by the executor.</li>
  <li><strong>pool-size</strong>: a gauge tracking the current number of threads in the pool.</li>
  <li><strong>active-threads</strong>: a gauge tracking the number of threads that are actively executing tasks.</li>
  <li><strong>processed-tasks</strong>: a gauge tracking the number of processed tasks for the executor. Please not that even while the
<code>ThreadPoolExecutor</code> provides us with the total number of tasks ever processed by the executor, this metrics is effectively
tracking the number of tasks as a differential from the last recorded value.</li>
</ul>


            </div>
          </div>
          <!--<div class="row align-items-center kamino-docs-bottom">
            <div class="col-xs-offset-1 col-xs-5">
                <a href="http://kamino.io">
                  <img class="img-fluid" alt="Sponsored by Kamino" src="/assets/img/sponsored-by-kamino.svg">
                </a>
                <a class="btn btn-sign-up btn-lg">Visit kamino.io</a>
            </div>
          </div>-->
        </div>

        <div class="col-12 col-md-3 pull-md-9 documentation-sidebar">
          <section>
  <ul class="tree">
    <li><a class="docs-level-three side" href="/documentation/get-started/"></i>Get Started</a></li>
    <li><a class="docs-level-three side" href="/documentation/events-and-workshops/"></i>Upcoming Events</a></li>
  </ul>
</section>
          


<section>
  <div class="tree tree-toggler docs-level-one row justify-content-between align-items-center">
    <span>
      kamon-akka
    </span>

    <div class="dropdown version-dropdown">
      <a class="btn btn-secondary dropdown-toggle" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        0.6.6
      </a>

      <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
        
          <a class="dropdown-item" href="/documentation/kamon-akka/0.6.6/overview/">0.6.6</a>
        
      </div>
    </div>
  </div>

  <ul>
    
      <li><a class="docs-level-three" href="/documentation/kamon-akka/0.6.6/overview/">Overview</a></li>
    
      <li><a class="docs-level-three" href="/documentation/kamon-akka/0.6.6/actor-router-and-dispatcher-metrics/">Actor, Router and Dispatcher Metrics</a></li>
    
      <li><a class="docs-level-three" href="/documentation/kamon-akka/0.6.6/automatic-trace-context-propagation/">Automatic TraceContext Propagation</a></li>
    
      <li><a class="docs-level-three" href="/documentation/kamon-akka/0.6.6/ask-pattern-timeout-warning/">Ask Pattern Timeout Warning</a></li>
    

    
</section>
          <section>
  <div class="tree tree-toggler docs-level-one row align-items-center">
    <span>All Modules</span>
  </div>
  <ul class="tree tree-toggler">
    <li>
      <label class="tree-toggler tree docs-level-two">Foundations</label>
      <ul>
        <li><a class="docs-level-three" href="/documentation/kamon-core/0.6.6/overview/">Metrics and Tracing</a></li>
      </ul>
    </li>

    <li>
      <label class="tree-toggler tree docs-level-two">Metrics Collection</label>
      <ul>
        <li><a class="docs-level-three" href="/documentation/kamon-akka/0.6.6/overview/">Akka</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-scala/0.6.6/overview/">Scala Futures</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-play/0.6.6/overview/">Play Framework</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-spray/0.6.6/overview/">Spray</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-jdbc/0.6.6/overview/">JDBC</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-annotation/0.6.6/overview/">Annotations</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-system-metrics/0.6.6/overview/">System Metrics</a></li>
      </ul>
    </li>

    <li>
      <label class="tree-toggler tree docs-level-two">Reporter Backends</label>
      <ul>
        <!--<li><a class="docs-level-three" href="/documentation/kamon-kamino/0.6.6/overview/">Kamino</a></li>-->
        <li><a class="docs-level-three" href="/documentation/kamon-statsd/0.6.6/overview/">StatsD</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-datadog/0.6.6/overview/">Datadog</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-newrelic/0.6.6/overview/">New Relic</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-sematext-spm/0.6.6/overview/">Sematext SPM</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-jmx/0.6.6/overview/">JMX</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-fluentd/0.6.6/overview/">FluentD</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-influxdb/0.6.6/overview/">InfluxDB</a></li>
        <!--<li><a class="docs-level-three" href="/documentation/kamon-graphite/1.0.4/overview/">Graphite</a></li>-->
        <li><a class="docs-level-three" href="/documentation/kamon-riemann/0.6.6/overview/">Riemann</a></li>
        <li><a class="docs-level-three" href="/documentation/kamon-khronus/0.6.6/overview/">Khronus</a></li>

      </ul>
    </li>    
  </ul>
</section>
        </div>

      </div>
    </div>

    <div class="hero jumbotron-bottom">
  <div class="container">
    <div class="row middle-xs">
      <div class="col-xs-12">
        
      </div>
    </div>
  </div>
</div>


<!--<footer class="footer">
  <div class="container">
    <div class="row">
      <div class="col-sm-8 col-sm-offset-2">
        <p class="text-center upper">
          Get in touch
        </p>
        <p class="text-center">
          <a href="https://twitter.com/kamonteam" class="social-icon"><i class="fa fa-twitter"></i></a>
          <a href="https://github.com/kamon-io/Kamon" class="social-icon"><i class="fa fa-2x fa-github"></i></a>
          <a href="/teamblog/rss/" class="social-icon"><i class="fa fa-rss"></i></a>
          <a href="https://groups.google.com/forum/#!forum/kamon-user" class="social-icon"><i class="fa fa-envelope"></i></a>
        </p>
        <p class="text-center">
          <a href="/introduction/project-info/support/" class="btn btn-support upper">Support <i class="fa fa-wrench"></i></a>
        </p>
        <p class="text-center">
          <img src="/assets/img/kamon-footer-logo.png" alt="logo" />
        </p>
        <p class="copyright">
          &copy; 2015 Kamon. All rights reserved.
        </p>
      </div>
    </div>
  </div>
</footer>-->



    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="/assets/js/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/assets/js/tether.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
    <script src="/assets/js/prism.js"></script>
    <script src="/assets/js/prism-typesafeconfig.js"></script>
    <script>

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-45369085-1', 'kamon.io');
    ga('send', 'pageview');

</script>

  </body>
</html>
